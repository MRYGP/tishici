## **Token优化系统 - 开箱即用完整包**

------

## 📄 **文件1：CURSOR_TEMPLATES.md**

复制以下内容，保存为 `CURSOR_TEMPLATES.md` 放在项目根目录：



markdown

~~~markdown
# CURSOR指令模板库

> 用于Claude快速引用的标准化指令模板
> 最后更新: [日期]

---

## 使用方法

Claude在需要CURSOR执行标准任务时，使用模板引用格式：
```
T[模板编号][参数列表]
```

CURSOR收到引用后，查找对应模板并执行完整指令。

---

## 📝 文档操作模板

### T001: 创建文档
**用法**: `T001[path, title, source_info]`

**完整指令**:
```
创建文档: {path}
标题: {title}
内容来源: {source_info}

要求:
- 使用Markdown标准格式
- 保持逻辑清晰，层次分明
- 添加必要的目录和交叉引用
```

**示例**:
```
T001[path=docs/核心概念.md, title=核心概念说明, source_info=从讨论中提取]
```

---

### T002: 更新文档
**用法**: `T002[path, section, content, reason]`

**完整指令**:
```
更新文档: {path}
章节: {section}
新内容: {content}
修改原因: {reason}

要求:
- 保持原有格式风格
- 更新"最后更新"时间戳
- 添加修改记录（如果文档有版本历史）
```

**示例**:
```
T002[path=docs/进度.md, section=本周任务, content=..., reason=完成状态更新]
```

---

### T003: 记录对话
**用法**: `T003[date, topic, key_points]`

**完整指令**:
```
任务: 生成讨论记录
对话范围: 用户会提供完整对话内容
输出路径: logs/{date}_{topic}.md
使用模板: DISCUSSION_RECORD_TEMPLATE.md

提取重点:
{key_points}

处理要求:
- 使用标准讨论记录格式
- 保留关键数据、结论、决策
- 突出风险和行动项
- 添加文档交叉引用
```

**示例**:
```
T003[date=2024-12-24, topic=架构设计, key_points=[性能优化,技术选型,风险评估]]
```

---

### T004: 归档文档
**用法**: `T004[files_list]`

**完整指令**:
```
移动以下文件到 archive/:
{files_list}

操作步骤:
1. 移动文件到归档目录
2. 在每个文件开头添加废弃标注:
   > **状态**: 已废弃
   > **替代文档**: [新文档路径]
   > **归档时间**: YYYY-MM-DD
   > **归档原因**: [简要说明]
3. 更新archive/README.md，添加归档记录
```

**示例**:
```
T004[files=[旧方案v1.md, 废弃设计.md]]
```

---

## 🔄 状态管理模板

### T101: 更新项目状态
**用法**: `T101[field, new_value, reason]`

**完整指令**:
```
更新 PROJECT_STATE.md

字段: {field}
新值: {new_value}
原因: {reason}

操作步骤:
1. 找到对应字段
2. 更新值
3. 在"最近重要变更"中添加记录
4. 更新"最后更新"时间戳
```

**示例**:
```
T101[field=当前优先级, new_value=性能优化, reason=用户反馈响应慢]
```

---

### T102: 记录重要决策
**用法**: `T102[decision_title, decision_content]`

**完整指令**:
```
在 PROJECT_STATE.md 的"最近重要决策"部分添加:

- [YYYY-MM-DD] {decision_title}
  简要说明: {decision_content}
  详见: [对应的详细记录]

同时创建对应的决策记录文件:
decisions/DEC-XXX_{decision_title}.md
```

**示例**:
```
T102[decision_title=采用微服务架构, decision_content=为了提升系统可扩展性和团队协作效率]
```

---

## 🏗️ 结构操作模板

### T201: 创建目录结构
**用法**: `T201[base_path, structure]`

**完整指令**:
```
在 {base_path} 下创建目录结构:
{structure}

为每个目录创建README.md说明文件
内容包括:
- 目录用途
- 文档列表（初始为待创建）
- 使用说明
```

**示例**:
```
T201[base_path=features/新功能, structure=[设计文档/, 技术方案/, 测试计划/]]
```

---

## 📋 批量操作模板

### T301: 批量重命名
**用法**: `T301[pattern, replacement, scope]`

**完整指令**:
```
批量重命名:
匹配模式: {pattern}
替换为: {replacement}
范围: {scope}

操作后:
- 更新所有引用这些文件的链接
- 记录重命名日志
```

---

## 🔧 自定义模板区

用户可以在此添加项目特定的模板，格式：
```markdown
### T9XXX: [模板名称]
**用法**: `T9XXX[参数]`
**完整指令**: ...
**示例**: ...
```

建议自定义模板编号从T9001开始。

---

## 📊 模板使用统计

| 模板 | 使用次数 | 最后使用 | 说明 |
|------|---------|----------|------|
| T001 | - | - | 创建文档 |
| T002 | - | - | 更新文档 |
| T003 | - | - | 记录对话 |
| T004 | - | - | 归档文档 |
| T101 | - | - | 更新状态 |
| T102 | - | - | 记录决策 |

---

*模板库会持续更新*
~~~

------

## 📄 **文件2：PROJECT_STATE.md**

复制以下内容，保存为 `PROJECT_STATE.md` 放在项目根目录：



markdown

```markdown
# [项目名称] 项目状态文件

> **这是项目的"仪表盘"和"单一真相来源"**
> 
> Claude每次对话应优先读取此文件，而非搜索多个文档
> 
> 最后更新: [日期]
> 更新者: [你的名字] + Claude

---

## 🎯 项目基本信息

**项目名称**: [项目名称]

**一句话定义**: [用一句话描述项目是什么]

**核心目标**: [这个项目要解决什么问题]

**关键成功指标**: [如何衡量成功]

---

## 📊 当前状态

### 项目阶段
**[探索期/设计期/开发期/测试期/上线期]** - [当前具体状态]

### 主要方向  
**[方向名称]**

原因:
- [原因1]
- [原因2]
- [原因3]

### 技术状态
[技术实现进展]

### 团队状态
[团队组成和协作状态]

---

## 🚨 当前最大风险

### 风险1: [风险名称] ⚠️⚠️⚠️⚠️⚠️
**描述**: [具体描述风险]

**影响**: [这个风险会造成什么后果]

**应对方案**: [如何应对]

**状态**: [已解决/方案已提出/待处理]

### 风险2: [风险名称] ⚠️⚠️⚠️⚠️
**描述**: 

**应对方案**: 

**状态**: 

### 风险3: [风险名称] ⚠️⚠️⚠️
**描述**: 

**应对方案**: 

**状态**: 

---

## ✅ 已验证的假设

| 假设 | 验证方式 | 结论 | 日期 |
|------|---------|------|------|
| [假设描述] | [如何验证的] | ✅/❌ | YYYY-MM-DD |

---

## ❓ 待验证的假设（高风险）

| 假设 | 风险等级 | 验证方式 | 预计时间 |
|------|---------|---------|----------|
| [假设描述] | 🔴/🟡/🟢 | [如何验证] | [时间] |

---

## 📈 关键指标与目标

### 短期目标（1-3个月）
- [目标1]
- [目标2]
- [目标3]

### 中期目标（3-6个月）
- [目标1]
- [目标2]

### 长期目标（6-12个月）
- [目标1]
- [目标2]

---

## 🔄 最近3个重要决策

### 1. [YYYY-MM-DD] [决策标题]
**决策**: [做了什么决定]
**理由**: [为什么这样决定]
**详见**: [相关文档链接]

### 2. [YYYY-MM-DD] [决策标题]
**决策**: 
**理由**: 
**详见**: 

### 3. [YYYY-MM-DD] [决策标题]
**决策**: 
**理由**: 
**详见**: 

---

## 📁 关键文档快速索引

### 核心文档
- [文档1](路径)
- [文档2](路径)
- [文档3](路径)

### 设计文档
- [设计1](路径)
- [设计2](路径)

### 会议记录
- [最近讨论](路径)

---

## 🔧 待办事项

### 本周
- [ ] 任务1
- [ ] 任务2
- [ ] 任务3

### 本月
- [ ] 任务1
- [ ] 任务2

### 下月
- [ ] 任务1
- [ ] 任务2

---

## 🎯 下一个里程碑

**里程碑**: [里程碑名称]
**预计日期**: YYYY-MM-DD
**成功标准**:
- [标准1]
- [标准2]
- [标准3]

---

## 💡 最近重要洞察

### [YYYY-MM-DD] [洞察标题]
[洞察内容]

### [YYYY-MM-DD] [洞察标题]
[洞察内容]

---

## 🔄 最近重要变更记录

| 日期 | 变更内容 | 影响 |
|------|---------|------|
| YYYY-MM-DD | [变更描述] | [影响说明] |

---

*此文件应该定期更新，或在重大决策/变更后立即更新*
```

------

## 📄 **文件3：DISCUSSION_RECORD_TEMPLATE.md**

复制以下内容，保存为 `DISCUSSION_RECORD_TEMPLATE.md` 放在项目根目录：



markdown

~~~markdown
# 讨论记录模板

> 用于CURSOR生成标准化的讨论记录

---

# [主题] 讨论记录

> **日期**: YYYY-MM-DD  
> **参与者**: [参与者列表]  
> **主题**: [一句话概括]  
> **时长**: 约X小时  
> **对话轮次**: ~X轮

---

## 📋 讨论议程

[列出本次讨论的主要议题，3-5个]

1. 议题1
2. 议题2
3. 议题3

---

## 第一部分：[第一个主要议题]

### 背景

[简要说明讨论这个议题的背景]

### 问题分析

[分析内容，提炼关键点]

### 关键发现

[列出最重要的发现，bullet points]

### 风险识别

[如果识别了风险，列出]

| 风险 | 严重程度 | 影响 | 应对方案 |
|------|---------|------|---------|
| ... | ... | ... | ... |

---

## 第二部分：[第二个主要议题]

[同上结构]

---

## 核心结论

### 关键洞察

[列出本次讨论最重要的洞察，3-5个]

1. 洞察1
2. 洞察2
3. 洞察3

### 达成的共识

[明确达成的决策或共识]

### 仍待解决的问题

[列出未解决的开放性问题]

---

## 下一步行动清单

### 立即执行（本周）
- [ ] 行动项1
- [ ] 行动项2

### 短期行动（2周内）
- [ ] 行动项3
- [ ] 行动项4

### 中期行动（1-2个月）
- [ ] 行动项5
- [ ] 行动项6

---

## 附录：重要数据/模型

[如果讨论中有重要的数据分析、模型、框架等，放在这里]

### [数据/模型标题]
```
[具体内容]
```

---

## 相关文档索引

### 讨论中引用的文档
- [文档1](路径)
- [文档2](路径)

### 本次讨论产生的文档
- [决策记录](路径)
- [更新的状态文件](路径)

---

## 思考与反思

### 方法论验证

[本次讨论验证了哪些方法论？哪些有效？哪些需要改进？]

### 关键学习

[本次讨论的关键学习点]

---

## 会议记录元数据

**记录者**: Claude / CURSOR  
**记录方式**: [实时记录/事后整理/自动生成]  
**文档状态**: ✅ 完整 / 🚧 草稿  
**下次回顾**: YYYY-MM-DD

---

*[一句话总结本次讨论的核心价值]*
~~~

------

## 📄 **System Prompt 修改内容**

在你的 Project 的 System Prompt 开头（第一个 `##` 标题之前）插入：



markdown

~~~markdown
## 🎯 Token优化原则

**核心理念**: Claude负责思考，CURSOR负责执行

### 默认输出模式：简洁优先

除非用户明确要求详细分析，否则Claude应采用简洁模式（<500 tokens）：
```
## 💡 核心观点
[1-3句话总结核心结论]

## 🚨 关键问题/风险
[3-5个关键要点，bullet points]

## 💊 建议方案
[简要说明，200字以内]

## 🔧 下一步行动
[给CURSOR的指令，或模板引用，或给用户的具体建议]

## 🤔 需要展开吗？
如需详细分析，可选择：
1. [展开选项1]
2. [展开选项2]
3. 全部详细分析
```

### 展开模式：深度分析

仅在以下情况使用完整的分析框架：
- 用户明确选择"详细分析"选项
- 用户直接要求"详细说明XXX"
- 问题复杂度确实需要深度分析

### 协作原则

1. **避免重复** - 不重复输出用户已看到的内容
2. **交给CURSOR** - 对话记录、文档整理等任务由CURSOR处理
3. **使用模板** - 标准化任务使用指令模板库（见`CURSOR_TEMPLATES.md`）
4. **维护状态** - 优先读取`PROJECT_STATE.md`而非搜索多个文档

---
~~~

然后找到你 System Prompt 中关于"工作流程"或"协作方式"的章节，在末尾添加：



markdown

```markdown
### Claude-Cursor协作模式

#### 模式A：直接指令模式
**适用场景**: 简单、明确的单一任务
**流程**: Claude输出指令 → CURSOR执行 → 完成

#### 模式B：对话归档模式
**适用场景**: 需要记录讨论过程时
**流程**: 
1. Claude输出简短的记录处理指令
2. 用户复制【整段对话】给CURSOR
3. CURSOR根据指令生成格式化记录

**重要**: 这种模式可节省50-70%的token

#### 模式C：模板引用模式
**适用场景**: 标准化、重复性任务
**流程**: Claude引用模板ID → CURSOR按模板执行

示例: `T003[date=2024-12-24, topic=主题, key_points=[要点1,要点2]]`

模板定义见 `CURSOR_TEMPLATES.md`

---
```

在 System Prompt 的任意合适位置（建议在"输出格式"相关章节）添加：



markdown

~~~markdown
## 📐 输出格式与Token管理

### 简洁模式（默认）

Claude的默认响应应该是高度精炼的，包含：

1. **核心观点** (1-3句话) - 最重要的结论是什么？
2. **关键问题** (3-5点) - 最需要注意的问题/风险是什么？
3. **建议方案** (200字内) - 应该怎么做？
4. **下一步行动** - 具体的、可执行的指令或建议
5. **展开选项** - 如果用户需要更多细节，提供选项

**目标token数**: 300-500 tokens

### 何时使用展开模式

只在以下情况提供详细分析：
- ✅ 用户明确选择展开选项
- ✅ 用户直接要求"详细分析XXX"
- ✅ 问题确实复杂，简洁模式无法说清
- ❌ 不要主动展开，除非确实必要

### Token预算意识

当Claude预计自己的回答会超过1000 tokens时，应该：
```
⚠️ Token预算提醒

本次详细回答预计需要 ~1500 tokens

可选方案：
1. 简洁版（~300 tokens）- 只给核心结论和建议
2. 完整版（~1500 tokens）- 包含详细分析和论证
3. 分段回答 - 先回答最重要的部分，然后根据需要展开

您希望哪种？
```

---
~~~

最后，在 System Prompt 末尾添加：



markdown

~~~markdown
## 🎛️ Token优化自检机制

### 每次输出前的自检清单

Claude在生成回复之前，必须进行以下检查：

#### 重复性检查
- [ ] 我是否在重复用户刚刚看到的内容？
- [ ] 我是否在重复上文已经说过的观点？
- [ ] 对话记录是否应该交给CURSOR处理？
- [ ] 我是否可以用"见上文"或链接代替重复？

#### 必要性检查
- [ ] 用户真的需要这个详细程度吗？
- [ ] 能否先给结论，让用户决定是否展开？
- [ ] 这个分析是否可以更精简？
- [ ] 能否用表格/列表代替长段落？

#### 分工检查
- [ ] 这个任务适合Claude还是CURSOR？
- [ ] 如果是文档操作，是否应该给CURSOR指令？
- [ ] 如果是文件创建，内容是否应该简化为大纲？

#### 效率检查
- [ ] 能否用模板引用代替完整指令？
- [ ] 指令是否足够简洁明确？
- [ ] 是否可以用PROJECT_STATE.md避免重复搜索？

### 定期反思机制

**触发条件**: 每10轮对话

**执行动作**: Claude主动输出优化建议

### 背景重建的优化

**旧方式**（高token消耗）:
```
用户: "继续讨论XXX"
Claude: [搜索10多个文档，消耗3000+ tokens]
```

**新方式**（低token消耗）:
```
用户: "继续讨论XXX"
Claude: [读取 PROJECT_STATE.md，消耗500 tokens]
```

**Token节省**: 每次新对话节省约2000-2500 tokens

---
```

---

## 📋 **实施步骤（5分钟）**

### Step 1: 创建文件（2分钟）
```
1. 复制 CURSOR_TEMPLATES.md → 粘贴到项目根目录
2. 复制 PROJECT_STATE.md → 粘贴到项目根目录（填充项目具体信息）
3. 复制 DISCUSSION_RECORD_TEMPLATE.md → 粘贴到项目根目录
```

### Step 2: 修改 System Prompt（3分钟）
```
1. 打开 Custom Instructions 或 System Prompt
2. 在开头插入"Token优化原则"
3. 在工作流程章节添加"Claude-Cursor协作模式"
4. 添加"输出格式与Token管理"
5. 在末尾添加"Token优化自检机制"
```

### Step 3: 测试验证（5分钟）
```
测试1：问Claude一个问题，观察是否使用简洁模式
测试2：问项目状态，观察Claude是否读取PROJECT_STATE.md
测试3：让Claude用T003记录对话，观察是否使用模板
~~~

------

## ✅ **验收清单**

-  3个核心文件已创建在项目根目录
-  System Prompt已添加4个模块
-  PROJECT_STATE.md已填充项目具体信息
-  测试简洁模式 - Claude默认回复<500 tokens
-  测试状态优先 - Claude优先读PROJECT_STATE
-  测试模板引用 - Claude能使用T00X格式

------

## 🎁 **额外工具**

### CURSOR使用指南

当你让CURSOR执行任务时，给它的标准格式：



markdown

```markdown
CURSOR，执行以下任务：

## 任务类型: [CREATE/UPDATE/RECORD]

## 目标: [具体要做什么]

## 具体指令:
[清晰的步骤]

## 完成标准:
- [ ] 标准1
- [ ] 标准2

请确认理解后开始执行。
```

### 快速定制PROJECT_STATE.md

根据项目类型选择字段：

**软件开发项目**：

- 添加：技术栈、部署状态、性能指标
- 删除：不适用的商业指标

**研究项目**：

- 添加：研究问题、实验进度、数据收集状态
- 删除：开发相关指标

**内容创作项目**：

- 添加：内容日历、发布计划、受众数据
- 删除：技术相关字段

------

## 📊 **预期效果**

使用这套系统后：

- **首次对话启动**：从3000 tokens → 500 tokens（节省83%）
- **日常对话**：从1500 tokens → 400 tokens（节省73%）
- **对话记录**：从10000 tokens → 5200 tokens（节省48%）
- **总体节省**：60-75%

------

## 🆘 **常见问题**

**Q: Claude不使用简洁模式怎么办？** A: 在对话中明确提醒："请使用简洁模式回答"

**Q: 如何知道TOKEN消耗是否真的降低了？** A: 在对话10轮后问Claude："我们目前消耗了多少token？"

**Q: 可以只用部分功能吗？** A: 可以！最有效的是：简洁模式 + PROJECT_STATE.md

**Q: 其他项目成员如何使用？** A: 把这3个文件和System Prompt分享给他们即可